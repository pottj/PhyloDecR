<!DOCTYPE html>

<html lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dr. Janne Pott (janne.pott@uni-leipzig.de)" />


<title>Getting Started with the PhyloDecR tool</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Getting Started with the PhyloDecR tool</h1>
<h3 class="subtitle">Algorithm to detect fixing taxa</h3>
<h4 class="author">Dr. Janne Pott (<a href="mailto:janne.pott@uni-leipzig.de" class="email">janne.pott@uni-leipzig.de</a>)</h4>
<h4 class="date">30 Mai, 2022</h4>



<div id="preamble" class="section level1">
<h1>Preamble</h1>
<p>This document is supposed to explain the algorithm used in the PhyloDecR package. It shortly describes the main steps.</p>
<p>For more information see XXX.</p>
<p>The functions are within two main files:</p>
<ul>
<li>myAlgorithm.R
<ul>
<li>check for fixing taxa in a given data set</li>
<li>input: data set with status (input, unresolved, [resovled]), index number (how many times was this data set tested yet?), verbose</li>
<li>output: data set with updated status (input, unresolved, [resovled])</li>
</ul></li>
<li>runAlgorithm.R
<ul>
<li>run algorithm in a repeat - break loop</li>
<li>loop breaks if there are no new resolved quadruples per index or no unresolved quadruples left</li>
<li>input: data set with status (input, unresolved, [resovled])</li>
<li>output: data set with updated status (input, unresolved, [resovled]) and round information (when did algorithm fail?)</li>
</ul></li>
</ul>
</div>
<div id="step-0-create-input-data" class="section level1">
<h1>Step 0: Create input data</h1>
<p>As example data, we use one quadruple set from Mareike Fischers Mathematica Algorithm:</p>
<ul>
<li>{1,2,3,5},</li>
<li>{1,3,5,6},</li>
<li>{2,3,5,6},</li>
<li>{1,2,3,6},</li>
<li>{2,3,4,6},</li>
<li>{1,3,4,6},</li>
<li>{1,2,4,6},</li>
<li>{1,2,5,6},</li>
<li>{1,4,5,6},</li>
<li>{1,2,4,5}, and</li>
<li>{2,3,4,5}</li>
</ul>
<p>We already know that this quadruple set is phylogenetic decisive. The quadruple are also stored in the <strong>PhyloDecR</strong> example data and can be read in easily with the <em>createInput()</em> function.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">=</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;example_2_Decisive.txt&quot;</span>, <span class="at">package =</span> <span class="st">&quot;PhyloDecR&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">createInput</span>(<span class="at">fn=</span>fn,<span class="at">sepSym =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Input contains 11 trees with 6 different taxa. The biggest tree has 4 taxa.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>verbose <span class="ot">=</span> T</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> test<span class="sc">$</span>data</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>data[status<span class="sc">==</span><span class="st">&quot;input&quot;</span>,quadruple]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;1_2_3_5&quot; &quot;1_2_3_6&quot; &quot;1_2_4_5&quot; &quot;1_2_4_6&quot; &quot;1_2_5_6&quot; &quot;1_3_4_6&quot; &quot;1_3_5_6&quot;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8] &quot;1_4_5_6&quot; &quot;2_3_4_5&quot; &quot;2_3_4_6&quot; &quot;2_3_5_6&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(test<span class="sc">$</span>data, <span class="at">caption =</span> <span class="st">&quot;Input data&quot;</span>)</span></code></pre></div>
<table>
<caption>Input data</caption>
<thead>
<tr class="header">
<th align="right">taxa1</th>
<th align="right">taxa2</th>
<th align="right">taxa3</th>
<th align="right">taxa4</th>
<th align="left">quadruple</th>
<th align="left">triple1</th>
<th align="left">triple2</th>
<th align="left">triple3</th>
<th align="left">triple4</th>
<th align="left">status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">1_2_3_4</td>
<td align="left">1_2_3</td>
<td align="left">1_2_4</td>
<td align="left">1_3_4</td>
<td align="left">2_3_4</td>
<td align="left">unresolved</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="left">1_2_3_5</td>
<td align="left">1_2_3</td>
<td align="left">1_2_5</td>
<td align="left">1_3_5</td>
<td align="left">2_3_5</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="left">1_2_3_6</td>
<td align="left">1_2_3</td>
<td align="left">1_2_6</td>
<td align="left">1_3_6</td>
<td align="left">2_3_6</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">1_2_4_5</td>
<td align="left">1_2_4</td>
<td align="left">1_2_5</td>
<td align="left">1_4_5</td>
<td align="left">2_4_5</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">1_2_4_6</td>
<td align="left">1_2_4</td>
<td align="left">1_2_6</td>
<td align="left">1_4_6</td>
<td align="left">2_4_6</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_2_5_6</td>
<td align="left">1_2_5</td>
<td align="left">1_2_6</td>
<td align="left">1_5_6</td>
<td align="left">2_5_6</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">1_3_4_5</td>
<td align="left">1_3_4</td>
<td align="left">1_3_5</td>
<td align="left">1_4_5</td>
<td align="left">3_4_5</td>
<td align="left">unresolved</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">1_3_4_6</td>
<td align="left">1_3_4</td>
<td align="left">1_3_6</td>
<td align="left">1_4_6</td>
<td align="left">3_4_6</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_3_5_6</td>
<td align="left">1_3_5</td>
<td align="left">1_3_6</td>
<td align="left">1_5_6</td>
<td align="left">3_5_6</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_4_5_6</td>
<td align="left">1_4_5</td>
<td align="left">1_4_6</td>
<td align="left">1_5_6</td>
<td align="left">4_5_6</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">2_3_4_5</td>
<td align="left">2_3_4</td>
<td align="left">2_3_5</td>
<td align="left">2_4_5</td>
<td align="left">3_4_5</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">2_3_4_6</td>
<td align="left">2_3_4</td>
<td align="left">2_3_6</td>
<td align="left">2_4_6</td>
<td align="left">3_4_6</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">2_3_5_6</td>
<td align="left">2_3_5</td>
<td align="left">2_3_6</td>
<td align="left">2_5_6</td>
<td align="left">3_5_6</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">2_4_5_6</td>
<td align="left">2_4_5</td>
<td align="left">2_4_6</td>
<td align="left">2_5_6</td>
<td align="left">4_5_6</td>
<td align="left">unresolved</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">3_4_5_6</td>
<td align="left">3_4_5</td>
<td align="left">3_4_6</td>
<td align="left">3_5_6</td>
<td align="left">4_5_6</td>
<td align="left">unresolved</td>
</tr>
</tbody>
</table>
</div>
<div id="step-1-initialize" class="section level1">
<h1>Step 1: Initialize</h1>
<div id="check-column-names" class="section level2">
<h2>Check column names</h2>
<p>The PhyloDecR algorithm expects all columns generated by <em>createInput()</em>. In the first step, we check if this is the case, and report again what the input is.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>expectedNames <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;taxa1&quot;</span>,<span class="st">&quot;taxa2&quot;</span>,<span class="st">&quot;taxa3&quot;</span>,<span class="st">&quot;taxa4&quot;</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;quadruple&quot;</span>,<span class="st">&quot;triple1&quot;</span>,<span class="st">&quot;triple2&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;triple3&quot;</span>,<span class="st">&quot;triple4&quot;</span>,<span class="st">&quot;status&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">names</span>(data) <span class="sc">%in%</span> expectedNames)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">class</span>(data<span class="sc">$</span>taxa1) <span class="sc">==</span> <span class="st">&quot;integer&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">table</span>(data<span class="sc">$</span>status)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> data<span class="sc">$</span>taxa4[<span class="fu">dim</span>(data)[<span class="dv">1</span>]]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(verbose <span class="sc">==</span> T){</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Using &quot;</span>,<span class="fu">as.numeric</span>(x[<span class="dv">1</span>]),<span class="st">&quot; of &quot;</span>,<span class="fu">dim</span>(data)[<span class="dv">1</span>], </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot; quadruples as input for algorithm (&quot;</span>,n,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot; unique taxa). </span><span class="sc">\n</span><span class="st"> This leaves &quot;</span>, <span class="fu">as.numeric</span>(x[<span class="dv">2</span>]),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot; quadruples unsolved.&quot;</span>)}</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using 11 of 15 quadruples as input for algorithm (6 unique taxa). </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  This leaves 4 quadruples unsolved.</span></span></code></pre></div>
</div>
<div id="set-parameters" class="section level2">
<h2>Set parameters</h2>
<p>We create some parameters:</p>
<ul>
<li>index=0: running index for the upcoming loop</li>
<li>round=0: new column in data set; should be set to round in which the quadruple can be resolved (e.g. round 0 for all input quadruples, round 1 for quadruples resolved in the first repeat loop)</li>
<li>fixingTaxa=0: used fixing taxon to resolve the quadruple (e.g. fixing taxa 0 for all input quadruples, fixing taxa &gt; 0 for all resolved quadruples)</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data2<span class="ot">&lt;-</span>data.table<span class="sc">::</span><span class="fu">copy</span>(data)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>index<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data2[,round <span class="sc">:</span><span class="er">=</span> <span class="dv">0</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data2[,fixingTaxa <span class="sc">:</span><span class="er">=</span> <span class="dv">0</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data2[,<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>)], <span class="at">caption =</span> <span class="st">&quot;Data before repeat loop&quot;</span>)</span></code></pre></div>
<table>
<caption>Data before repeat loop</caption>
<thead>
<tr class="header">
<th align="left">quadruple</th>
<th align="left">status</th>
<th align="right">round</th>
<th align="right">fixingTaxa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1_2_3_4</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">1_2_3_5</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1_2_3_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">1_2_4_5</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1_2_4_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">1_2_5_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1_3_4_5</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">1_3_4_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1_3_5_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">1_4_5_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2_3_4_5</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2_3_4_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2_3_5_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2_4_5_6</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">3_4_5_6</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="step-2-repeat-loop" class="section level1">
<h1>Step 2: Repeat loop</h1>
<p>In the second step, we start a <em>repeat</em> loop. It contains the following sub-steps:</p>
<ol style="list-style-type: decimal">
<li>Apply function <em>myAlgorithm</em> and increase index parameter by 1</li>
<li>Check for change and break the <em>repeat</em> loop if
<ul>
<li>there are no more unresolved quadruples (–&gt; phylo. dec.) or</li>
<li>there are no new resolved quadruples (–&gt; not phylo dec. or not resolvable via this algorithm)</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">repeat</span>{</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  data2<span class="ot">=</span><span class="fu">myAlgorithm</span>(<span class="at">data =</span> data2,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">roundnumber =</span> index,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> verbose)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  index<span class="ot">=</span>index<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  data2</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop should stop if there are no new resolved quadruples or no unresolved quadruples</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  check1 <span class="ot">=</span> (<span class="fu">sum</span>(data2<span class="sc">$</span>round <span class="sc">==</span> index) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  check2 <span class="ot">=</span> (<span class="fu">sum</span>(data2<span class="sc">$</span>status <span class="sc">==</span> <span class="st">&quot;unresolved&quot;</span>) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (check1 <span class="sc">|</span> check2){</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <em>myAlgorithm</em> function tests there are fixing taxa for unresolved quadruples given the input quadruples. That happens in the following four steps.</p>
<div id="step-2.1-split-data" class="section level2">
<h2>Step 2.1: Split data</h2>
<p>First, we split the given data by their status: a quadruple is either unresolved and hence tested for fixing taxa or input/resolved and can be used to find the fixing taxa.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_solved <span class="ot">=</span> data2[status <span class="sc">!=</span> <span class="st">&quot;unresolved&quot;</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data_unresolved <span class="ot">=</span> data2[status <span class="sc">==</span> <span class="st">&quot;unresolved&quot;</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data_unresolved, <span class="at">caption =</span> <span class="st">&quot;Unresolved quadruples&quot;</span>)</span></code></pre></div>
<table>
<caption>Unresolved quadruples</caption>
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="11%" />
<col width="6%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">taxa1</th>
<th align="right">taxa2</th>
<th align="right">taxa3</th>
<th align="right">taxa4</th>
<th align="left">quadruple</th>
<th align="left">triple1</th>
<th align="left">triple2</th>
<th align="left">triple3</th>
<th align="left">triple4</th>
<th align="left">status</th>
<th align="right">round</th>
<th align="right">fixingTaxa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">1_2_3_4</td>
<td align="left">1_2_3</td>
<td align="left">1_2_4</td>
<td align="left">1_3_4</td>
<td align="left">2_3_4</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">1_3_4_5</td>
<td align="left">1_3_4</td>
<td align="left">1_3_5</td>
<td align="left">1_4_5</td>
<td align="left">3_4_5</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">2_4_5_6</td>
<td align="left">2_4_5</td>
<td align="left">2_4_6</td>
<td align="left">2_5_6</td>
<td align="left">4_5_6</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">3_4_5_6</td>
<td align="left">3_4_5</td>
<td align="left">3_4_6</td>
<td align="left">3_5_6</td>
<td align="left">4_5_6</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="step-2.2-foreach-loop" class="section level2">
<h2>Step 2.2: Foreach loop</h2>
<p>A <em>foreach</em> loop is simply a for loop with some advantages regarding parallelization (not yet implemented). It tests wach unresolved quadruple for a fixing taxon. In this example, we only use <span class="math inline">\(i=1\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example for i=1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>data_unresolved[i,quadruple]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1_2_3_4&quot;</span></span></code></pre></div>
<div id="step-2.2.1-get-all-triples" class="section level3">
<h3>Step 2.2.1: Get all triples</h3>
<p>We create a vector containing all four triples that can be constructed using the four taxa of the unresolved quadruple (cross quadruple, CQ)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>triples_CQ<span class="ot">&lt;-</span>data_unresolved[i,<span class="fu">c</span>(<span class="st">&quot;triple1&quot;</span>,<span class="st">&quot;triple2&quot;</span>,<span class="st">&quot;triple3&quot;</span>,<span class="st">&quot;triple4&quot;</span>)]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>triples_CQ <span class="ot">=</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(triples_CQ))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>triples_CQ</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1_2_3&quot; &quot;1_2_4&quot; &quot;1_3_4&quot; &quot;2_3_4&quot;</span></span></code></pre></div>
</div>
<div id="step-2.2.2-check-overlap-with-resolved-triples" class="section level3">
<h3>Step 2.2.2: Check overlap with resolved triples</h3>
<p>Next, we check if these CQ based triples occur in the resolved data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>vgl1<span class="ot">&lt;-</span><span class="fu">is.element</span>(data_solved<span class="sc">$</span>triple1,triples_CQ)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>vgl2<span class="ot">&lt;-</span><span class="fu">is.element</span>(data_solved<span class="sc">$</span>triple2,triples_CQ)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>vgl3<span class="ot">&lt;-</span><span class="fu">is.element</span>(data_solved<span class="sc">$</span>triple3,triples_CQ)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>vgl4<span class="ot">&lt;-</span><span class="fu">is.element</span>(data_solved<span class="sc">$</span>triple4,triples_CQ)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>filt<span class="ot">&lt;-</span>vgl1 <span class="sc">|</span> vgl2 <span class="sc">|</span> vgl3 <span class="sc">|</span> vgl4</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>data_pos<span class="ot">&lt;-</span>data_solved[filt,]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data_pos[,<span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>], <span class="at">caption =</span> <span class="st">&quot;Resolved quadruples that cover at least one triple of the analyzed CQ&quot;</span>)</span></code></pre></div>
<table>
<caption>Resolved quadruples that cover at least one triple of the analyzed CQ</caption>
<thead>
<tr class="header">
<th align="left">quadruple</th>
<th align="left">triple1</th>
<th align="left">triple2</th>
<th align="left">triple3</th>
<th align="left">triple4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1_2_3_5</td>
<td align="left">1_2_3</td>
<td align="left">1_2_5</td>
<td align="left">1_3_5</td>
<td align="left">2_3_5</td>
</tr>
<tr class="even">
<td align="left">1_2_3_6</td>
<td align="left">1_2_3</td>
<td align="left">1_2_6</td>
<td align="left">1_3_6</td>
<td align="left">2_3_6</td>
</tr>
<tr class="odd">
<td align="left">1_2_4_5</td>
<td align="left">1_2_4</td>
<td align="left">1_2_5</td>
<td align="left">1_4_5</td>
<td align="left">2_4_5</td>
</tr>
<tr class="even">
<td align="left">1_2_4_6</td>
<td align="left">1_2_4</td>
<td align="left">1_2_6</td>
<td align="left">1_4_6</td>
<td align="left">2_4_6</td>
</tr>
<tr class="odd">
<td align="left">1_3_4_6</td>
<td align="left">1_3_4</td>
<td align="left">1_3_6</td>
<td align="left">1_4_6</td>
<td align="left">3_4_6</td>
</tr>
<tr class="even">
<td align="left">2_3_4_5</td>
<td align="left">2_3_4</td>
<td align="left">2_3_5</td>
<td align="left">2_4_5</td>
<td align="left">3_4_5</td>
</tr>
<tr class="odd">
<td align="left">2_3_4_6</td>
<td align="left">2_3_4</td>
<td align="left">2_3_6</td>
<td align="left">2_4_6</td>
<td align="left">3_4_6</td>
</tr>
</tbody>
</table>
<p>In this example, there are 7 input/resolved quadruples, that share at least one triple with our unresolved one. This means, there are 7 taxa that can be tried as fixing taxa (CQ based triple + taxon <span class="math inline">\(x\)</span> = resolved or input quadruple).</p>
</div>
<div id="step-2.2.3-search-for-fixing-taxa" class="section level3">
<h3>Step 2.2.3: Search for fixing taxa</h3>
<p>Now we count the fourth taxa that is not in the triple. If one taxa <span class="math inline">\(x\)</span> appears four times, then all four quadruples of the CQ triples + <span class="math inline">\(x\)</span> are in the input data, and <span class="math inline">\(x\)</span> is a fixing taxon for the unresolved CQ.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>taxa_pos <span class="ot">=</span> <span class="fu">unlist</span>(data_pos[,<span class="fu">c</span>(<span class="st">&quot;taxa1&quot;</span>,<span class="st">&quot;taxa2&quot;</span>,<span class="st">&quot;taxa3&quot;</span>,<span class="st">&quot;taxa4&quot;</span>)])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>taxa_unresolved <span class="ot">=</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(data_unresolved[i,<span class="fu">c</span>(<span class="st">&quot;taxa1&quot;</span>,<span class="st">&quot;taxa2&quot;</span>,<span class="st">&quot;taxa3&quot;</span>,<span class="st">&quot;taxa4&quot;</span>)]))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>taxa_pos2 <span class="ot">=</span> taxa_pos[<span class="sc">!</span><span class="fu">is.element</span>(taxa_pos,taxa_unresolved)]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">taxa_ID =</span> taxa_pos2)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">=</span> tab[,.N, by<span class="ot">=</span>taxa_ID]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tab2, <span class="at">caption =</span> <span class="st">&quot;Possible fixing taxa and their count&quot;</span>)</span></code></pre></div>
<table>
<caption>Possible fixing taxa and their count</caption>
<thead>
<tr class="header">
<th align="right">taxa_ID</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tab3 <span class="ot">=</span> tab2[N <span class="sc">==</span> <span class="fu">max</span>(N),]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(tab3)[<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">1</span>){tab3 <span class="ot">=</span> tab3[<span class="dv">1</span>,]}</span></code></pre></div>
<p>So taxa <span class="math inline">\(5\)</span> appears in three quadruples (1235, 1245, and 2345), and taxa <span class="math inline">\(6\)</span> four quadruples (1236, 1246, 2346, and 2346) - taxa <span class="math inline">\(6\)</span> is a fixing taxa for unresolved quadruple 1234.</p>
</div>
<div id="step-2.2.4-return-data" class="section level3">
<h3>Step 2.2.4: Return data</h3>
<p>As result, we generate a data table with the unresolved quadruple, the best fixing taxa and the number of its counts.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">unres_quad =</span> data_unresolved[i,quadruple],</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">best_fixTaxa =</span> tab3<span class="sc">$</span>taxa_ID,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">count =</span> tab3<span class="sc">$</span>N)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(res, <span class="at">caption =</span> <span class="st">&quot;Possible fixing taxon with its highest count&quot;</span>)</span></code></pre></div>
<table>
<caption>Possible fixing taxon with its highest count</caption>
<thead>
<tr class="header">
<th align="left">unres_quad</th>
<th align="right">best_fixTaxa</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1_2_3_4</td>
<td align="right">6</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="step-2.3-check-count" class="section level2">
<h2>Step 2.3: Check count</h2>
<p>After the <em>foreach</em> loop, we have a data table containing all our unresolved quadruples:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>myTab <span class="ot">=</span> foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data_unresolved)[<span class="dv">1</span>]) <span class="sc">%do%</span>{</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># i=1</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.2.1: Get all triples</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  triples_CQ<span class="ot">&lt;-</span>data_unresolved[i,<span class="fu">c</span>(<span class="st">&quot;triple1&quot;</span>,<span class="st">&quot;triple2&quot;</span>,<span class="st">&quot;triple3&quot;</span>,<span class="st">&quot;triple4&quot;</span>)]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  triples_CQ <span class="ot">=</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(triples_CQ))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.2.2: Check overlap with resolved triples</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  vgl1<span class="ot">&lt;-</span><span class="fu">is.element</span>(data_solved<span class="sc">$</span>triple1,triples_CQ)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  vgl2<span class="ot">&lt;-</span><span class="fu">is.element</span>(data_solved<span class="sc">$</span>triple2,triples_CQ)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  vgl3<span class="ot">&lt;-</span><span class="fu">is.element</span>(data_solved<span class="sc">$</span>triple3,triples_CQ)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  vgl4<span class="ot">&lt;-</span><span class="fu">is.element</span>(data_solved<span class="sc">$</span>triple4,triples_CQ)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  filt<span class="ot">&lt;-</span>vgl1 <span class="sc">|</span> vgl2 <span class="sc">|</span> vgl3 <span class="sc">|</span> vgl4</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  data_pos<span class="ot">&lt;-</span>data_solved[filt,]</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">dim</span>(data_pos)[<span class="dv">1</span>]<span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2.2.3: Search for fixing taxa </span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    taxa_pos <span class="ot">=</span> <span class="fu">unlist</span>(data_pos[,<span class="fu">c</span>(<span class="st">&quot;taxa1&quot;</span>,<span class="st">&quot;taxa2&quot;</span>,<span class="st">&quot;taxa3&quot;</span>,<span class="st">&quot;taxa4&quot;</span>)])</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    taxa_unresolved <span class="ot">=</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(data_unresolved[i,<span class="fu">c</span>(<span class="st">&quot;taxa1&quot;</span>,<span class="st">&quot;taxa2&quot;</span>,<span class="st">&quot;taxa3&quot;</span>,<span class="st">&quot;taxa4&quot;</span>)]))</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    taxa_pos2 <span class="ot">=</span> taxa_pos[<span class="sc">!</span><span class="fu">is.element</span>(taxa_pos,taxa_unresolved)]</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    tab <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">taxa_ID =</span> taxa_pos2)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    tab2 <span class="ot">=</span> tab[,.N, by<span class="ot">=</span>taxa_ID]</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    tab3 <span class="ot">=</span> tab2[N <span class="sc">==</span> <span class="fu">max</span>(N),]</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">dim</span>(tab3)[<span class="dv">1</span>]<span class="sc">!=</span><span class="dv">0</span>){tab3 <span class="ot">=</span> tab3[<span class="dv">1</span>,]}</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2.2.4: Return data</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">unres_quad =</span> data_unresolved[i,quadruple],</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">best_fixTaxa =</span> tab3<span class="sc">$</span>taxa_ID,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">count =</span> tab3<span class="sc">$</span>N)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2.2.4: Return data</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">unres_quad =</span> data_unresolved[i,quadruple],</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">best_fixTaxa =</span> <span class="dv">0</span>,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">count =</span> <span class="dv">0</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  res</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>myTab <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">rbindlist</span>(myTab)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>myTab</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    unres_quad best_fixTaxa count</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:    1_2_3_4            6     4</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:    1_3_4_5            2     3</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:    2_4_5_6            1     4</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4:    3_4_5_6            1     3</span></span></code></pre></div>
<p>We check for how many unresolved quadruples there are best fixing taxa with <span class="math inline">\(count\geq 4\)</span>. Those can be set to <em>resolved</em>, they get as round the current round and as fixing taxa the best fixing taxa.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>roundnumber <span class="ot">=</span> index</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>round_old <span class="ot">=</span> <span class="fu">max</span>(data2<span class="sc">$</span>round)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(myTab<span class="sc">$</span>unres_quad <span class="sc">==</span> data_unresolved<span class="sc">$</span>quadruple)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>filt <span class="ot">=</span> myTab<span class="sc">$</span>count<span class="sc">&gt;=</span><span class="dv">4</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>data_unresolved[filt,status <span class="sc">:</span><span class="er">=</span> <span class="st">&quot;resolved&quot;</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>data_unresolved[filt,fixingTaxa <span class="sc">:</span><span class="er">=</span> myTab[filt,best_fixTaxa]]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>data_unresolved[filt,round <span class="sc">:</span><span class="er">=</span> roundnumber <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data_unresolved[,<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>)], <span class="at">caption =</span> <span class="st">&quot;Unresolved quadruples after the foreach loop&quot;</span>)</span></code></pre></div>
<table>
<caption>Unresolved quadruples after the foreach loop</caption>
<thead>
<tr class="header">
<th align="left">quadruple</th>
<th align="left">status</th>
<th align="right">round</th>
<th align="right">fixingTaxa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1_2_3_4</td>
<td align="left">resolved</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">1_3_4_5</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2_4_5_6</td>
<td align="left">resolved</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">3_4_5_6</td>
<td align="left">unresolved</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="step-2.4-return-data" class="section level2">
<h2>Step 2.4: Return data</h2>
<p>Finally, we return the data set to the <em>repeat</em> loop.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">=</span> <span class="fu">rbind</span>(data_solved,data_unresolved)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data3<span class="sc">$</span>status)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      input   resolved unresolved </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         11          2          2</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>tab4<span class="ot">&lt;-</span>data3[,.N,by<span class="ot">=</span>status]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>n_unresolved_new <span class="ot">=</span> tab4[status <span class="sc">==</span> <span class="st">&quot;unresolved&quot;</span>,N]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(n_unresolved_new)<span class="sc">==</span><span class="dv">0</span>){n_unresolved_new <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>n_unresolved_old <span class="ot">=</span> <span class="fu">dim</span>(data_unresolved)[<span class="dv">1</span>]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>n_diff <span class="ot">=</span> n_unresolved_old <span class="sc">-</span> n_unresolved_new</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>round_new <span class="ot">=</span> <span class="fu">max</span>(data3<span class="sc">$</span>round)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(round_new <span class="sc">==</span> round_old){round_new <span class="ot">=</span> round_new <span class="sc">+</span> <span class="dv">1</span>}</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(verbose <span class="sc">==</span> T){<span class="fu">message</span>(<span class="st">&quot;In round #&quot;</span>,round_new,<span class="st">&quot;, &quot;</span>,n_diff,<span class="st">&quot; quadruples could be resolved ...&quot;</span>)}</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; In round #1, 2 quadruples could be resolved ...</span></span></code></pre></div>
<p>After returning the new data set with updated status, we check for change and break the <em>repeat</em> loop if * there are no more unresolved quadruples (–&gt; phylo. dec.) or * there are no new resolved quadruples (–&gt; not phylo dec. or not resolvable via this algorithm)</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># copied from the chunk 7 and set to data3 as example</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>check1 <span class="ot">=</span> (<span class="fu">sum</span>(data3<span class="sc">$</span>round <span class="sc">==</span> index) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>check2 <span class="ot">=</span> (<span class="fu">sum</span>(data3<span class="sc">$</span>status <span class="sc">==</span> <span class="st">&quot;unresolved&quot;</span>) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>check1 <span class="sc">|</span> check2</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Both checks are FALSE (in the last call of the algorithm quadruples could be solved and there are still unsolved ones), so the <em>repeat</em> loop goes into the next round. If one of them were TRUE, the loop stops.</p>
</div>
</div>
<div id="step-3-return-data-and-result" class="section level1">
<h1>Step 3: Return data and result</h1>
<p>As soon as the <em>repeat</em> loop stops, we can evaluate our findings: can all cross-quadruples be resolved by fixing taxa (in multiple rounds)? If so, the data set is phylogenically decisive. If not, it is either not phylogenically decisive or not resolvable via fixing taxa.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># copied from the chunk 7 and set to data3 as example - just one round</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(verbose <span class="sc">==</span> T){</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(data3<span class="sc">$</span>status <span class="sc">==</span> <span class="st">&quot;unresolved&quot;</span>) <span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;PHYLOGENETICALLY DECISIVE&quot;</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;NOT RESOLVABLE VIA THIS ALGORITHM, MAYBE A SECOND FIXING TAXON IS NEEDED&quot;</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;NOT RESOLVABLE VIA THIS ALGORITHM, MAYBE A SECOND FIXING TAXON IS NEEDED&quot;</span></span></code></pre></div>
</div>
<div id="example-using-phylodecr" class="section level1">
<h1>Example using PhyloDecR</h1>
<p>Now we use the previous data set and apply the functions from our PhyloDecR package.</p>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fn2 <span class="ot">=</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;example_2_Decisive.txt&quot;</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">package =</span> <span class="st">&quot;PhyloDecR&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>test2 <span class="ot">=</span> <span class="fu">createInput</span>(<span class="at">fn=</span>fn2, <span class="at">sepSym =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Input contains 11 trees with 6 different taxa. The biggest tree has 4 taxa.</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(test2<span class="sc">$</span>input_raw,<span class="at">caption =</span> <span class="st">&quot;Input from text file. Does not need to be numeric, does not need to be quadruples&quot;</span>)</span></code></pre></div>
<table>
<caption>Input from text file. Does not need to be numeric, does not need to be quadruples</caption>
<thead>
<tr class="header">
<th align="right">V1</th>
<th align="right">V2</th>
<th align="right">V3</th>
<th align="right">V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(test2<span class="sc">$</span>input_quadruples,<span class="at">caption =</span> <span class="st">&quot;Input quadruples. If in input was a tree with more than four taxa, all quadruples in that tree are added here&quot;</span>)</span></code></pre></div>
<table>
<caption>Input quadruples. If in input was a tree with more than four taxa, all quadruples in that tree are added here</caption>
<thead>
<tr class="header">
<th align="right">taxa1</th>
<th align="right">taxa2</th>
<th align="right">taxa3</th>
<th align="right">taxa4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(test2<span class="sc">$</span>input_ordered,<span class="at">caption =</span> <span class="st">&quot;Input quadruples, all numeric from 1 to n (different taxa in input).&quot;</span>)</span></code></pre></div>
<table>
<caption>Input quadruples, all numeric from 1 to n (different taxa in input).</caption>
<thead>
<tr class="header">
<th align="right">taxa1</th>
<th align="right">taxa2</th>
<th align="right">taxa3</th>
<th align="right">taxa4</th>
<th align="left">quadruple</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="left">1_2_3_5</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_3_5_6</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">2_3_5_6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="left">1_2_3_6</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">2_3_4_6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">1_3_4_6</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">1_2_4_6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_2_5_6</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_4_5_6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">1_2_4_5</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">2_3_4_5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(test2<span class="sc">$</span>taxa, <span class="at">caption =</span> <span class="st">&quot;Transfomation matrix in case of character taxa&quot;</span>)</span></code></pre></div>
<table>
<caption>Transfomation matrix in case of character taxa</caption>
<thead>
<tr class="header">
<th align="right">taxaID</th>
<th align="right">NR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(test2<span class="sc">$</span>data, <span class="at">caption =</span> <span class="st">&quot;Input data for algorithm&quot;</span>)</span></code></pre></div>
<table>
<caption>Input data for algorithm</caption>
<thead>
<tr class="header">
<th align="right">taxa1</th>
<th align="right">taxa2</th>
<th align="right">taxa3</th>
<th align="right">taxa4</th>
<th align="left">quadruple</th>
<th align="left">triple1</th>
<th align="left">triple2</th>
<th align="left">triple3</th>
<th align="left">triple4</th>
<th align="left">status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">1_2_3_4</td>
<td align="left">1_2_3</td>
<td align="left">1_2_4</td>
<td align="left">1_3_4</td>
<td align="left">2_3_4</td>
<td align="left">unresolved</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="left">1_2_3_5</td>
<td align="left">1_2_3</td>
<td align="left">1_2_5</td>
<td align="left">1_3_5</td>
<td align="left">2_3_5</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="left">1_2_3_6</td>
<td align="left">1_2_3</td>
<td align="left">1_2_6</td>
<td align="left">1_3_6</td>
<td align="left">2_3_6</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">1_2_4_5</td>
<td align="left">1_2_4</td>
<td align="left">1_2_5</td>
<td align="left">1_4_5</td>
<td align="left">2_4_5</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">1_2_4_6</td>
<td align="left">1_2_4</td>
<td align="left">1_2_6</td>
<td align="left">1_4_6</td>
<td align="left">2_4_6</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_2_5_6</td>
<td align="left">1_2_5</td>
<td align="left">1_2_6</td>
<td align="left">1_5_6</td>
<td align="left">2_5_6</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">1_3_4_5</td>
<td align="left">1_3_4</td>
<td align="left">1_3_5</td>
<td align="left">1_4_5</td>
<td align="left">3_4_5</td>
<td align="left">unresolved</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">1_3_4_6</td>
<td align="left">1_3_4</td>
<td align="left">1_3_6</td>
<td align="left">1_4_6</td>
<td align="left">3_4_6</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_3_5_6</td>
<td align="left">1_3_5</td>
<td align="left">1_3_6</td>
<td align="left">1_5_6</td>
<td align="left">3_5_6</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_4_5_6</td>
<td align="left">1_4_5</td>
<td align="left">1_4_6</td>
<td align="left">1_5_6</td>
<td align="left">4_5_6</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">2_3_4_5</td>
<td align="left">2_3_4</td>
<td align="left">2_3_5</td>
<td align="left">2_4_5</td>
<td align="left">3_4_5</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">2_3_4_6</td>
<td align="left">2_3_4</td>
<td align="left">2_3_6</td>
<td align="left">2_4_6</td>
<td align="left">3_4_6</td>
<td align="left">input</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">2_3_5_6</td>
<td align="left">2_3_5</td>
<td align="left">2_3_6</td>
<td align="left">2_5_6</td>
<td align="left">3_5_6</td>
<td align="left">input</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">2_4_5_6</td>
<td align="left">2_4_5</td>
<td align="left">2_4_6</td>
<td align="left">2_5_6</td>
<td align="left">4_5_6</td>
<td align="left">unresolved</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">3_4_5_6</td>
<td align="left">3_4_5</td>
<td align="left">3_4_6</td>
<td align="left">3_5_6</td>
<td align="left">4_5_6</td>
<td align="left">unresolved</td>
</tr>
</tbody>
</table>
<p>The input files look like:</p>
<ul>
<li>input_raw: data as given in the .txt file.</li>
<li>input_quadruples: interim result, data transformed into quadruples only</li>
<li>input_ordered: data transformed to quadruples, and taxa ID forced to numeric and ordered hierarchically</li>
<li>data: all possible quadruples given the taxon set with status information (quadruple as input available, quadruple not in input = unresolved). In addition, all four triples possible by each quadruple are listed</li>
<li>taxa: data table used for transformation, taxaID denotes the original input taxaID (as in input_raw &amp; input_quadruples), NR is the ordered number of this taxon (as in input_ordered &amp; data)</li>
</ul>
</div>
<div id="test-data" class="section level2">
<h2>Test data</h2>
<p>Now we test our data for fixing taxa and phylogenetic decisiveness.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>test2_alg<span class="ot">&lt;-</span><span class="fu">runAlgorithm</span>(<span class="at">data =</span> test2<span class="sc">$</span>data,<span class="at">verbose =</span> T)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using 11 of 15 quadruples as input for algorithm (6 unique taxa). </span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  This leaves 4 quadruples unsolved.</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; In round #1, 2 quadruples could be resolved ...</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; In round #2, 2 quadruples could be resolved ...</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;PHYLOGENETICALLY DECISIVE&quot;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(test2_alg, <span class="at">caption =</span> <span class="st">&quot;Output data of algorithm&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption>Output data of algorithm</caption>
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="6%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">taxa1</th>
<th align="right">taxa2</th>
<th align="right">taxa3</th>
<th align="right">taxa4</th>
<th align="left">quadruple</th>
<th align="left">triple1</th>
<th align="left">triple2</th>
<th align="left">triple3</th>
<th align="left">triple4</th>
<th align="left">status</th>
<th align="right">round</th>
<th align="right">fixingTaxa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="left">1_2_3_5</td>
<td align="left">1_2_3</td>
<td align="left">1_2_5</td>
<td align="left">1_3_5</td>
<td align="left">2_3_5</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="left">1_2_3_6</td>
<td align="left">1_2_3</td>
<td align="left">1_2_6</td>
<td align="left">1_3_6</td>
<td align="left">2_3_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">1_2_4_5</td>
<td align="left">1_2_4</td>
<td align="left">1_2_5</td>
<td align="left">1_4_5</td>
<td align="left">2_4_5</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">1_2_4_6</td>
<td align="left">1_2_4</td>
<td align="left">1_2_6</td>
<td align="left">1_4_6</td>
<td align="left">2_4_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_2_5_6</td>
<td align="left">1_2_5</td>
<td align="left">1_2_6</td>
<td align="left">1_5_6</td>
<td align="left">2_5_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">1_3_4_6</td>
<td align="left">1_3_4</td>
<td align="left">1_3_6</td>
<td align="left">1_4_6</td>
<td align="left">3_4_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_3_5_6</td>
<td align="left">1_3_5</td>
<td align="left">1_3_6</td>
<td align="left">1_5_6</td>
<td align="left">3_5_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">1_4_5_6</td>
<td align="left">1_4_5</td>
<td align="left">1_4_6</td>
<td align="left">1_5_6</td>
<td align="left">4_5_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">2_3_4_5</td>
<td align="left">2_3_4</td>
<td align="left">2_3_5</td>
<td align="left">2_4_5</td>
<td align="left">3_4_5</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="left">2_3_4_6</td>
<td align="left">2_3_4</td>
<td align="left">2_3_6</td>
<td align="left">2_4_6</td>
<td align="left">3_4_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">2_3_5_6</td>
<td align="left">2_3_5</td>
<td align="left">2_3_6</td>
<td align="left">2_5_6</td>
<td align="left">3_5_6</td>
<td align="left">input</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">1_2_3_4</td>
<td align="left">1_2_3</td>
<td align="left">1_2_4</td>
<td align="left">1_3_4</td>
<td align="left">2_3_4</td>
<td align="left">resolved</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">2_4_5_6</td>
<td align="left">2_4_5</td>
<td align="left">2_4_6</td>
<td align="left">2_5_6</td>
<td align="left">4_5_6</td>
<td align="left">resolved</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left">1_3_4_5</td>
<td align="left">1_3_4</td>
<td align="left">1_3_5</td>
<td align="left">1_4_5</td>
<td align="left">3_4_5</td>
<td align="left">resolved</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">3_4_5_6</td>
<td align="left">3_4_5</td>
<td align="left">3_4_6</td>
<td align="left">3_5_6</td>
<td align="left">4_5_6</td>
<td align="left">resolved</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="to-do" class="section level1">
<h1>To do:</h1>
<ul>
<li>add documentation for <em>FixingTaxonTraceability.R</em></li>
</ul>
</div>
<div id="runtime" class="section level1">
<h1>Runtime</h1>
<ul>
<li>n = number of taxa</li>
<li>N = number of possible quadruples with n taxa</li>
<li>k = number of input quadruples</li>
<li>N-k = unresolved quadruples</li>
</ul>
<p>Worst case scenario: I can solve only one quadruple at each <em>repeat</em> loop –&gt; O(N-k)</p>
<p>Checking overlap for each triple: four times all solved quadruples –&gt; O(4k)</p>
<p>Search for taxa: all but the four taxa of the analyzed quadruple are possible –&gt; O(n-4)</p>
<p>Taken together: <span class="math inline">\(O((N-k) * (4k+n-4))\)</span>?</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
