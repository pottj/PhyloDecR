---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# PhyloDecR

<!-- badges: start -->
<!-- badges: end -->

The goal of PhyloDecR is to check sets of taxon sets for phylogenetic decisiveness in R.

## Installation

Once published, you can install the released version of PhyloDecR from [CRAN](https://CRAN.R-project.org) with:

``` r
install.packages("PhyloDecR")
```

Currently, only the development version from [GitHub](https://github.com/) is available with:

``` r
# install.packages("devtools")
devtools::install_github("pottNeJa/PhyloDecR")
```
## To do

* Discuss with Mareike: is my version of her algorithm correct? 
* Check master thesis for further conditions

## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
library(PhyloDecR)

## basic example data sets
fn1 = system.file("extdata", 
                  "example_1_notDecisive.txt", 
                  package = "PhyloDecR")
fn2 = system.file("extdata", 
                  "example_2_Decisive.txt", 
                  package = "PhyloDecR")
fn3 = system.file("extdata", 
                  "example_3_Decisive.txt", 
                  package = "PhyloDecR")



```

### Step 1: Create Input

```{r step1}
test1 = createInput(fn=fn1,sepSym = ",")
test2 = createInput(fn=fn2,sepSym = ",")
test3 = createInput(fn=fn3, sepSym = "_")

knitr::kable(test1$input_raw,caption = "Input from text file. Does not need to be numeric, does not need to be quadruples")

knitr::kable(test1$input_quadruples,caption = "Input quadruples. If in input was a tree with more than four taxa, all quadruples in that tree are added here")

knitr::kable(test1$input_ordered,caption = "Input quadruples, all numeric from 1 to n (different taxa in input).")

knitr::kable(test1$taxa, caption = "Transfomation matrix")

head(test1$data)
```

### Step 2: Do some initial tests
The second input, *test2*, contains data for 11 taxa lists of 6 different taxa. 

First, we want to check if this input data is okay for the algorithm. There are three conditions (proof see master thesis):

1) Input Quadruple size has to be large enough ($n-1 \choose 3$)to make this algorithm work. See Theorem 5 / Conjecture of master thesis
2) All triples must to be in the input data! See Lemma 1 of master thesis.
3) All tuples must be sufficiently available! --> See Theorem 6 of master thesis.

```{r checkInput}
test1_checks = initialCheck(data = test1$data)
test2_checks = initialCheck(data = test2$data)
test3_checks = initialCheck(data = test3$data)

```

Not all data pass the test. 

* Data 1: low quadruple number & not all tuples sufficiently available --> Algorithm will not be able to give a positive result
* Data 2: all initial checks passed --> algorithm should be able to give true positive or true negative result
* Data 3: low quadruple number --> algorithm will not be able to give a positive result

```{r algorithm, warning=F}
test1_alg<-runAlgorithm(data = test1$data,verbose = T)
test2_alg<-runAlgorithm(data = test2$data,verbose = T)
test3_alg<-runAlgorithm(data = test3$data,verbose = T)
```

The algorithm cannot give false positives! If there are fixing taxa to resolve all quadruples, the set is phylogenetic decisive (proof of proposition 7 of Fischer Preprint).

The algorithm can give false negatives! For example, the third example set is phylogenetic decisive, but has not enough quadruples in the set to enable the algorithm to find fixing taxa (see master thesis, theorem 2).

